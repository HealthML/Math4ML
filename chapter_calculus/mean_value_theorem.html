
<!DOCTYPE html>


<html lang="en" data-content_root="../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Mean value theorem &#8212; Mathematics for Machine Learning</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../_static/styles/bootstrap.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../_static/styles/pydata-sphinx-theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />

  
  <link href="../_static/vendor/fontawesome/6.5.2/css/all.min.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=03e43079" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/sphinx-book-theme.css?v=eba8b062" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css?v=4fa983c6" />
    <link rel="stylesheet" type="text/css" href="../_static/proof.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-design.min.css?v=95c83b7e" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b" />
<link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b" />
  <script src="../_static/vendor/fontawesome/6.5.2/js/all.min.js?digest=dfe6caa3a7d634c4db9b"></script>

    <script src="../_static/documentation_options.js?v=9eb32ce0"></script>
    <script src="../_static/doctools.js?v=9a2dae69"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../_static/copybutton.js?v=f281be69"></script>
    <script src="../_static/scripts/sphinx-book-theme.js?v=887ef09a"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../_static/togglebutton.js?v=4a39c7ea"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../_static/design-tabs.js?v=f930bc37"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script async="async" src="../_static/sphinx-thebe.js?v=c100c467"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'chapter_calculus/mean_value_theorem';</script>
    <link rel="canonical" href="https://healthml.github.io/Math4ML/chapter_calculus/mean_value_theorem.html" />
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="First-order condition for local minima" href="minima_first_order_condition.html" />
    <link rel="prev" title="The chain rule" href="chain_rule.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-primary-sidebar-checkbox"/>
  <label class="overlay overlay-primary" for="pst-primary-sidebar-checkbox"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-secondary-sidebar-checkbox"/>
  <label class="overlay overlay-secondary" for="pst-secondary-sidebar-checkbox"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  
    
  

<a class="navbar-brand logo" href="../index.html">
  
  
  
  
  
    
    
      
    
    
    <img src="../_static/hpi-logo-colored.svg" class="logo__image only-light" alt="Mathematics for Machine Learning - Home"/>
    <script>document.write(`<img src="../_static/hpi-logo-colored.svg" class="logo__image only-dark" alt="Mathematics for Machine Learning - Home"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item">

 <script>
 document.write(`
   <button class="btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../index.html">
                    Preface
                </a>
            </li>
        </ul>
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">Mathematics for Machine Learning</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../chapter_ml_basics/intro.html">Machine Learning Problems</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../chapter_ml_basics/classification.html">Classification</a></li>
<li class="toctree-l2"><a class="reference internal" href="../chapter_ml_basics/regression.html">Regression</a></li>
<li class="toctree-l2"><a class="reference internal" href="../chapter_ml_basics/clustering.html">Clustering</a></li>
<li class="toctree-l2"><a class="reference internal" href="../chapter_ml_basics/representation_learning.html">Representation Learning</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../chapter_spaces/overview_spaces.html">Vector and Function Spaces</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../chapter_spaces/vector_spaces.html">Vector Spaces</a></li>
<li class="toctree-l2"><a class="reference internal" href="../chapter_spaces/polynomial_vector_space.html">Polynomial Vector Space</a></li>
<li class="toctree-l2"><a class="reference internal" href="../chapter_spaces/basis_functions_vector_space.html">Basis Functions Vector Space</a></li>
<li class="toctree-l2"><a class="reference internal" href="../chapter_spaces/subspaces.html">Subspaces</a></li>
<li class="toctree-l2"><a class="reference internal" href="../chapter_spaces/metric_spaces.html">Metric Spaces</a></li>
<li class="toctree-l2"><a class="reference internal" href="../chapter_spaces/normed_spaces.html">Normed Spaces</a></li>
<li class="toctree-l2"><a class="reference internal" href="../chapter_spaces/inner_product_spaces.html">Inner Product Spaces</a></li>
<li class="toctree-l2"><a class="reference internal" href="../chapter_spaces/transposition.html">Transposition</a></li>
</ul>
</details></li>
<li class="toctree-l1 current active has-children"><a class="reference internal" href="overview_calculus.html">Calculus and Optimization</a><details open="open"><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="extrema.html">Extrema</a></li>
<li class="toctree-l2"><a class="reference internal" href="gradients.html">Gradients</a></li>
<li class="toctree-l2"><a class="reference internal" href="gradient_descent_ridge.html">Gradient Descent</a></li>
<li class="toctree-l2"><a class="reference internal" href="matrix_calculus.html">Matrix Calculus</a></li>
<li class="toctree-l2"><a class="reference internal" href="jacobian.html">Jacobian</a></li>
<li class="toctree-l2"><a class="reference internal" href="chain_rule.html">Chain Rule</a></li>
<li class="toctree-l2 current active"><a class="current reference internal" href="#">Mean Value Theorem</a></li>
<li class="toctree-l2"><a class="reference internal" href="minima_first_order_condition.html">First Order Condition</a></li>
<li class="toctree-l2"><a class="reference internal" href="analytical_solution_ridge.html">Quadratic Optimization</a></li>
<li class="toctree-l2"><a class="reference internal" href="line_search.html">Line Search</a></li>
<li class="toctree-l2"><a class="reference internal" href="hessian.html">Hessian</a></li>
<li class="toctree-l2"><a class="reference internal" href="taylors_theorem.html">Taylor’s Theorem</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../chapter_decompositions/overview_decompositions.html">Matrix Analysis</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../chapter_decompositions/matrix_rank.html">Rank of a Matrix</a></li>
<li class="toctree-l2"><a class="reference internal" href="../chapter_decompositions/determinant.html">Determinant</a></li>
<li class="toctree-l2"><a class="reference internal" href="../chapter_decompositions/row_equivalence.html">Gaussian Elimination and the PLU Decomposition</a></li>
<li class="toctree-l2"><a class="reference internal" href="../chapter_decompositions/square_matrices.html">Fundamental Equivalences for Square matrices</a></li>
<li class="toctree-l2"><a class="reference internal" href="../chapter_decompositions/trace.html">Trace</a></li>
<li class="toctree-l2"><a class="reference internal" href="../chapter_decompositions/eigenvectors.html">Eigenvalues and Eigenvectors</a></li>
<li class="toctree-l2"><a class="reference internal" href="../chapter_decompositions/orthogonal_matrices.html">Orthogonal matrices</a></li>
<li class="toctree-l2"><a class="reference internal" href="../chapter_decompositions/symmetric_matrices.html">Symmetric matrices</a></li>
<li class="toctree-l2"><a class="reference internal" href="../chapter_decompositions/Rayleigh_quotients.html">Rayleigh Quotients</a></li>
<li class="toctree-l2"><a class="reference internal" href="../chapter_decompositions/matrix_norms.html">Matrix Norms</a></li>
<li class="toctree-l2"><a class="reference internal" href="../chapter_decompositions/psd_matrices.html">Positive (semi-)definite matrices</a></li>
<li class="toctree-l2"><a class="reference internal" href="../chapter_decompositions/pca.html">Principal Components Analysis</a></li>
<li class="toctree-l2"><a class="reference internal" href="../chapter_decompositions/svd.html">Singular value decomposition</a></li>
<li class="toctree-l2"><a class="reference internal" href="../chapter_decompositions/pseudoinverse.html">Moore-Penrose Pseudoinverse</a></li>
<li class="toctree-l2"><a class="reference internal" href="../chapter_decompositions/orthogonal_projections.html">Orthogonal projections</a></li>
<li class="toctree-l2"><a class="reference internal" href="../chapter_decompositions/big_picture.html">Fundamental Subspaces</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../chapter_convexity/overview_convexity.html">Convexity</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../chapter_convexity/convex_sets.html">Convex sets</a></li>
<li class="toctree-l2"><a class="reference internal" href="../chapter_convexity/convex_functions.html">Basics of convex functions</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../chapter_second_order/overview_second_order.html">Second-Order Optimization</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../chapter_second_order/minima_second_order_condition.html">Second Order Condition for Minima</a></li>
<li class="toctree-l2"><a class="reference internal" href="../chapter_second_order/newtons_method.html">Newton’s Method</a></li>
</ul>
</details></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Appendix</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../appendix/proofs.html">Detailed Proofs</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../appendix/Cauchy%E2%80%93Schwarz_inequality.html">Cauchy-Schwarz Inequality</a></li>
<li class="toctree-l2"><a class="reference internal" href="../appendix/Bolzano-Weierstrass_theorem.html">Bolzano-Weierstrass Theorem</a></li>
<li class="toctree-l2"><a class="reference internal" href="../appendix/extreme_value_theorem.html">Extreme Value Theorem</a></li>
<li class="toctree-l2"><a class="reference internal" href="../appendix/Rolles_theorem.html">Rolle's Theorem</a></li>
<li class="toctree-l2"><a class="reference internal" href="../appendix/mean_value_theorem_proof.html">Mean Value Theorem</a></li>
<li class="toctree-l2"><a class="reference internal" href="../appendix/scalar-scalar_chain_rule.html">Chain Rule for Scalar-Scalar Functions</a></li>
<li class="toctree-l2"><a class="reference internal" href="../appendix/squeeze_theorem.html">Squeeze Theorem</a></li>
<li class="toctree-l2"><a class="reference internal" href="../appendix/first_fundamental_theorem_calculus.html">First Fundamental Theorem of Calculus</a></li>
<li class="toctree-l2"><a class="reference internal" href="../appendix/second_fundamental_theorem_calculus.html">Second Fundamental Theorem of Calculus</a></li>
<li class="toctree-l2"><a class="reference internal" href="../appendix/Clairauts_theorem.html">Clairaut's Theorem</a></li>
</ul>
</details></li>
<li class="toctree-l1"><a class="reference internal" href="../appendix/differentiation_rules.html">Differentiation Rules</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../appendix/Exercise%20Sheet%20Solutions.html">Exercise Sheet Solutions</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../appendix/Exercise%20Sheet%201%20Solutions.html">Exercise Sheet 1 Solutions</a></li>
<li class="toctree-l2"><a class="reference internal" href="../appendix/Exercise%20Sheet%202%20Solutions.html">Exercise Sheet 2 Solutions</a></li>
<li class="toctree-l2"><a class="reference internal" href="../appendix/Exercise%20Sheet%203%20Solutions.html">Exercise Sheet 3 Solutions</a></li>
<li class="toctree-l2"><a class="reference internal" href="../appendix/Exercise%20Sheet%204%20Solutions.html">Exercise Sheet 4 Solutions</a></li>
</ul>
</details></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><button class="sidebar-toggle primary-toggle btn btn-sm" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</button></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/HealthML/Math4ML" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/HealthML/Math4ML/edit/main/book/chapter_calculus/mean_value_theorem.md" target="_blank"
   class="btn btn-sm btn-source-edit-button dropdown-item"
   title="Suggest edit"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-pencil-alt"></i>
  </span>
<span class="btn__text-container">Suggest edit</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/HealthML/Math4ML/issues/new?title=Issue%20on%20page%20%2Fchapter_calculus/mean_value_theorem.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../_sources/chapter_calculus/mean_value_theorem.md" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.md</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="theme-switch fa-solid fa-sun fa-lg" data-mode="light"></i>
    <i class="theme-switch fa-solid fa-moon fa-lg" data-mode="dark"></i>
    <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"></i>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm pst-navbar-icon search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<button class="sidebar-toggle secondary-toggle btn btn-sm" title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</button>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Mean value theorem</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#mean-value-theorem-in-1-variable">Mean value theorem in 1 variable</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#mean-value-theorem-for-real-valued-functions-in-several-variables">Mean Value Theorem for real-valued Functions in Several Variables</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#mean-value-theorem-for-vector-valued-functions">Mean Value Theorem for Vector-Valued Functions</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#summary">Summary</a></li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="mean-value-theorem">
<h1>Mean value theorem<a class="headerlink" href="#mean-value-theorem" title="Link to this heading">#</a></h1>
<p>We discuss the Mean Value Theorem (MVT) in both single and multiple variables. The MVT is a fundamental theorem in calculus that provides a connection between the derivative of a function and its average rate of change over an interval.</p>
<p>The MVT will help us understand the gradient descent algorithm and its convergence properties. It will also be a cornerstone for the Taylor expansion, which is a powerful tool for approximating functions and the basis of second order optimization algorithms.</p>
<section id="mean-value-theorem-in-1-variable">
<h2>Mean value theorem in 1 variable<a class="headerlink" href="#mean-value-theorem-in-1-variable" title="Link to this heading">#</a></h2>
<p>The Mean Value Theorem (MVT) is one of the cornerstones of single‐variable calculus.  Informally, it says that for any smooth curve connecting two points, there is at least one point in between where the instantaneous slope (the derivative) matches the average slope over the whole interval.
The MVT is a special case of the <strong>Fundamental Theorem of Calculus</strong> that links the derivative of a function to its integral.</p>
<div class="proof theorem admonition" id="thm-mean-value-theorem">
<p class="admonition-title"><span>Theorem </span> (Mean value theorem)</p>
<section class="theorem-content" id="proof-content">
<p>Let <span class="math notranslate nohighlight">\(f:[a,b]\to\mathbb{R}\)</span> be a continuous function on the closed interval <span class="math notranslate nohighlight">\([a,b]\)</span>, and differentiable on the open interval <span class="math notranslate nohighlight">\((a,b)\)</span>, where <span class="math notranslate nohighlight">\(a\neq b\)</span>.</p>
<p>Then there exists some <span class="math notranslate nohighlight">\(c \in (a,b)\)</span> such that</p>
<div class="math notranslate nohighlight">
\[f'(c)=\frac{f(b)-f(a)}{b-a}.\]</div>
</section>
</div><p>In other words, the tangent line at <span class="math notranslate nohighlight">\(x=c\)</span> is exactly parallel to the secant line joining <span class="math notranslate nohighlight">\((a,f(a))\)</span> and <span class="math notranslate nohighlight">\((b,f(b))\)</span>. A proof of the MVT is provided in the Appendix.</p>
<p>Below, we illustrate the MVT for the cubic <span class="math notranslate nohighlight">\(f(x)=x + x^3\)</span> on the intervals <span class="math notranslate nohighlight">\([0.5,2.0]\)</span> and <span class="math notranslate nohighlight">\([-1.5,1.5]\)</span>.</p>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>

<span class="c1"># Define the function and its derivative</span>
<span class="k">def</span><span class="w"> </span><span class="nf">f</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>   <span class="k">return</span> <span class="n">x</span><span class="o">**</span><span class="mi">3</span> <span class="o">+</span> <span class="n">x</span>
<span class="k">def</span><span class="w"> </span><span class="nf">df</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>  <span class="k">return</span> <span class="mi">3</span> <span class="o">*</span> <span class="n">x</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">1</span>

<span class="c1"># Intervals for demonstration</span>
<span class="n">intervals</span> <span class="o">=</span> <span class="p">[</span>
    <span class="p">(</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">2.0</span><span class="p">,</span> <span class="s2">&quot;Interval [0.5, 2.0]&quot;</span><span class="p">),</span>
    <span class="p">(</span><span class="o">-</span><span class="mf">1.5</span><span class="p">,</span> <span class="mf">1.5</span><span class="p">,</span> <span class="s2">&quot;Interval [-1.5, 1.5] (inflection)&quot;</span><span class="p">)</span>
<span class="p">]</span>

<span class="c1"># Prepare figure with two subplots</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">14</span><span class="p">,</span> <span class="mi">7</span><span class="p">),</span> <span class="n">sharey</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="n">x_all</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mf">1.7</span><span class="p">,</span> <span class="mf">2.5</span><span class="p">,</span> <span class="mi">400</span><span class="p">)</span>

<span class="k">for</span> <span class="n">ax</span><span class="p">,</span> <span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">title</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">axes</span><span class="p">,</span> <span class="n">intervals</span><span class="p">):</span>
    <span class="c1"># Compute secant slope</span>
    <span class="n">m</span> <span class="o">=</span> <span class="p">(</span><span class="n">f</span><span class="p">(</span><span class="n">b</span><span class="p">)</span> <span class="o">-</span> <span class="n">f</span><span class="p">(</span><span class="n">a</span><span class="p">))</span> <span class="o">/</span> <span class="p">(</span><span class="n">b</span> <span class="o">-</span> <span class="n">a</span><span class="p">)</span>
    <span class="c1"># Solve f&#39;(c) = m =&gt; 3 c^2 + 1 = m =&gt; c = ±sqrt( (m-1)/3 )</span>
    <span class="n">cs</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">sol</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">((</span><span class="n">m</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="o">/</span> <span class="mi">3</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="p">[</span> <span class="n">sol</span><span class="p">,</span> <span class="o">-</span><span class="n">sol</span><span class="p">]:</span>
        <span class="k">if</span> <span class="n">a</span> <span class="o">&lt;</span> <span class="n">c</span> <span class="o">&lt;</span> <span class="n">b</span><span class="p">:</span>
            <span class="n">cs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">c</span><span class="p">)</span>

    <span class="c1"># Plot the true function</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x_all</span><span class="p">,</span> <span class="n">f</span><span class="p">(</span><span class="n">x_all</span><span class="p">),</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;$f(x)=x^3$&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;gold&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
    <span class="c1"># Plot the secant line</span>
    <span class="n">secant</span> <span class="o">=</span> <span class="n">f</span><span class="p">(</span><span class="n">a</span><span class="p">)</span> <span class="o">+</span> <span class="n">m</span> <span class="o">*</span> <span class="p">(</span><span class="n">x_all</span> <span class="o">-</span> <span class="n">a</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x_all</span><span class="p">,</span> <span class="n">secant</span><span class="p">,</span> <span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;Secant (slope=</span><span class="si">{</span><span class="n">m</span><span class="si">:</span><span class="s1">.2f</span><span class="si">}</span><span class="s1">)&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;orange&#39;</span><span class="p">)</span>

    <span class="c1"># Plot tangent(s) at each c</span>
    <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">cs</span><span class="p">:</span>
        <span class="n">tangent</span> <span class="o">=</span> <span class="n">f</span><span class="p">(</span><span class="n">c</span><span class="p">)</span> <span class="o">+</span> <span class="n">m</span> <span class="o">*</span> <span class="p">(</span><span class="n">x_all</span> <span class="o">-</span> <span class="n">c</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x_all</span><span class="p">,</span> <span class="n">tangent</span><span class="p">,</span> <span class="s1">&#39;:&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;Tangent at c=</span><span class="si">{</span><span class="n">c</span><span class="si">:</span><span class="s1">.2f</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">scatter</span><span class="p">([</span><span class="n">c</span><span class="p">],</span> <span class="p">[</span><span class="n">f</span><span class="p">(</span><span class="n">c</span><span class="p">)],</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="mi">80</span><span class="p">)</span>

    <span class="c1"># Mark endpoints</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">scatter</span><span class="p">([</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">],</span> <span class="p">[</span><span class="n">f</span><span class="p">(</span><span class="n">a</span><span class="p">),</span> <span class="n">f</span><span class="p">(</span><span class="n">b</span><span class="p">)],</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="mi">80</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">([</span><span class="o">-</span><span class="mi">7</span><span class="p">,</span><span class="mi">15</span><span class="p">])</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">([</span><span class="o">-</span><span class="mf">1.7</span><span class="p">,</span> <span class="mf">2.5</span><span class="p">])</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="n">title</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>

<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;f(x)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">suptitle</span><span class="p">(</span><span class="s1">&#39;Mean Value Theorem: Secant vs Tangent—Including Inflection Example&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">(</span><span class="n">rect</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mf">0.03</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mf">0.95</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<img alt="../_images/23c334d1ff0969b05679835aad06f0867ae419f0dbc973c3827a7b56d6bf7773.png" src="../_images/23c334d1ff0969b05679835aad06f0867ae419f0dbc973c3827a7b56d6bf7773.png" />
</div>
</div>
<p>We observe that for the interval <span class="math notranslate nohighlight">\([0.5,2.0]\)</span>, the secant line (orange dashed) and the tangent line (red dotted) at <span class="math notranslate nohighlight">\(x=c\)</span> are parallel, as expected.
For the interval <span class="math notranslate nohighlight">\([-1.5,1.5]\)</span>, we see that the secant line is parallel to the tangent line at two different points <span class="math notranslate nohighlight">\(c_1\)</span> and <span class="math notranslate nohighlight">\(c_2\)</span>. The existence of multiple different points with parallel tangent lines is consistent with the MVT, as the function <span class="math notranslate nohighlight">\(f\)</span> can have inflection points  where the second derivative changes its sign within the interval, such as <span class="math notranslate nohighlight">\(x=0\)</span> in our example.</p>
</section>
<section id="mean-value-theorem-for-real-valued-functions-in-several-variables">
<h2>Mean Value Theorem for real-valued Functions in Several Variables<a class="headerlink" href="#mean-value-theorem-for-real-valued-functions-in-several-variables" title="Link to this heading">#</a></h2>
<p>The Mean Value Theorem can be extended to real-valued functions of several variables.</p>
<div class="proof corollary admonition" id="thm-mean-value-theorem-multivariable">
<p class="admonition-title"><span>Corollary </span> (Mean value theorem for several variables)</p>
<section class="corollary-content" id="proof-content">
<p>If <span class="math notranslate nohighlight">\(f:\mathbf{R}^n\to\mathbf{R}\)</span> be continuously differentiable, then for any two points <span class="math notranslate nohighlight">\(\mathbf{x},\mathbf{y}\in\mathbf{R}^n\)</span>, there exists a point <span class="math notranslate nohighlight">\(\mathbf{z}\)</span> on the line segment <span class="math notranslate nohighlight">\(\mathbf{z}(t)=(1-t)\mathbf{x}+t\mathbf{y}\)</span>, <span class="math notranslate nohighlight">\(t\in[0,1]\)</span>, such that</p>
<div class="math notranslate nohighlight">
\[
f(\mathbf{y})-f(\mathbf{x})=\nabla f(\mathbf{z})^\top (\mathbf{y}-\mathbf{x}).
\]</div>
</section>
</div><p>Before we prove this corollary, we will first illustrate it with a simple example.</p>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>

<span class="c1"># Define multivariate function and its gradient</span>
<span class="k">def</span><span class="w"> </span><span class="nf">f2d</span><span class="p">(</span><span class="n">X</span><span class="p">):</span>
    <span class="c1"># X: array of shape (n_points, 2)</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">X</span><span class="o">**</span><span class="mi">2</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

<span class="k">def</span><span class="w"> </span><span class="nf">grad_f2d</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
    <span class="c1"># x: array shape (2,)</span>
    <span class="k">return</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">x</span>

<span class="c1"># Choose two points in R^2</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="o">-</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">])</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">2.0</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.0</span><span class="p">])</span>
<span class="n">z</span> <span class="o">=</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="p">(</span><span class="n">x</span> <span class="o">+</span> <span class="n">y</span><span class="p">)</span>  <span class="c1"># midpoint c=0.5</span>

<span class="c1"># Direction vector and function values</span>
<span class="n">d</span> <span class="o">=</span> <span class="n">y</span> <span class="o">-</span> <span class="n">x</span>
<span class="n">f_x</span> <span class="o">=</span> <span class="n">f2d</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">newaxis</span><span class="p">,</span> <span class="p">:])[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">f_y</span> <span class="o">=</span> <span class="n">f2d</span><span class="p">(</span><span class="n">y</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">newaxis</span><span class="p">,</span> <span class="p">:])[</span><span class="mi">0</span><span class="p">]</span>

<span class="c1"># Define g(t) and its derivative g&#39;(t)</span>
<span class="k">def</span><span class="w"> </span><span class="nf">g</span><span class="p">(</span><span class="n">t</span><span class="p">):</span>
    <span class="n">X_t</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">t</span><span class="p">)[:,</span> <span class="kc">None</span><span class="p">]</span> <span class="o">*</span> <span class="n">x</span> <span class="o">+</span> <span class="n">t</span><span class="p">[:,</span> <span class="kc">None</span><span class="p">]</span> <span class="o">*</span> <span class="n">y</span>
    <span class="k">return</span> <span class="n">f2d</span><span class="p">(</span><span class="n">X_t</span><span class="p">)</span>

<span class="k">def</span><span class="w"> </span><span class="nf">g_prime</span><span class="p">(</span><span class="n">t</span><span class="p">):</span>
    <span class="n">X_t</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">t</span><span class="p">)[:,</span> <span class="kc">None</span><span class="p">]</span> <span class="o">*</span> <span class="n">x</span> <span class="o">+</span> <span class="n">t</span><span class="p">[:,</span> <span class="kc">None</span><span class="p">]</span> <span class="o">*</span> <span class="n">y</span>
    <span class="n">grads</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">grad_f2d</span><span class="p">(</span><span class="n">pt</span><span class="p">)</span> <span class="k">for</span> <span class="n">pt</span> <span class="ow">in</span> <span class="n">X_t</span><span class="p">])</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ij,j-&gt;i&#39;</span><span class="p">,</span> <span class="n">grads</span><span class="p">,</span> <span class="n">d</span><span class="p">)</span>

<span class="c1"># Sample t values</span>
<span class="n">t_vals</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">200</span><span class="p">)</span>
<span class="n">g_vals</span> <span class="o">=</span> <span class="n">g</span><span class="p">(</span><span class="n">t_vals</span><span class="p">)</span>
<span class="n">secant_line</span> <span class="o">=</span> <span class="n">f_x</span> <span class="o">+</span> <span class="p">(</span><span class="n">f_y</span> <span class="o">-</span> <span class="n">f_x</span><span class="p">)</span> <span class="o">*</span> <span class="n">t_vals</span>
<span class="n">tangent_line</span> <span class="o">=</span> <span class="n">f2d</span><span class="p">(</span><span class="n">z</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">newaxis</span><span class="p">,</span> <span class="p">:])[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">z</span><span class="p">)</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">d</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">t_vals</span> <span class="o">-</span> <span class="mf">0.5</span><span class="p">)</span>  <span class="c1"># slope = g&#39;(0.5)</span>

<span class="c1"># Plotting</span>
<span class="n">fig</span><span class="p">,</span> <span class="p">(</span><span class="n">ax1</span><span class="p">,</span> <span class="n">ax2</span><span class="p">)</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">14</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>

<span class="c1"># Left: contour in R^2</span>
<span class="n">xx</span><span class="p">,</span> <span class="n">yy</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">meshgrid</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">200</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">200</span><span class="p">))</span>
<span class="n">XY</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">stack</span><span class="p">([</span><span class="n">xx</span><span class="o">.</span><span class="n">ravel</span><span class="p">(),</span> <span class="n">yy</span><span class="o">.</span><span class="n">ravel</span><span class="p">()],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">zz</span> <span class="o">=</span> <span class="n">f2d</span><span class="p">(</span><span class="n">XY</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">xx</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="n">contours</span> <span class="o">=</span> <span class="n">ax1</span><span class="o">.</span><span class="n">contour</span><span class="p">(</span><span class="n">xx</span><span class="p">,</span> <span class="n">yy</span><span class="p">,</span> <span class="n">zz</span><span class="p">,</span> <span class="n">levels</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;viridis&#39;</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">clabel</span><span class="p">(</span><span class="n">contours</span><span class="p">,</span> <span class="n">inline</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">8</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="o">*</span><span class="n">x</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="mi">80</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="o">*</span><span class="n">y</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;green&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;y&#39;</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="mi">80</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="o">*</span><span class="n">z</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;z = midpoint&#39;</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="mi">80</span><span class="p">)</span>

<span class="c1"># Gradient arrow at z</span>
<span class="n">grad_z</span> <span class="o">=</span> <span class="n">grad_f2d</span><span class="p">(</span><span class="n">z</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">arrow</span><span class="p">(</span><span class="n">z</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">z</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">grad_z</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">grad_z</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span>
          <span class="n">head_width</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span> <span class="n">head_length</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;∇f(z)&#39;</span><span class="p">)</span>
<span class="c1"># Direction arrow (y-x) at z</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">arrow</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">d</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">d</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span>
          <span class="n">head_width</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span> <span class="n">head_length</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;orange&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;y - x&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>

<span class="n">ax1</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Contour of $f(x_1,x_2)=x_1^2+x_2^2$</span><span class="se">\n</span><span class="s1">with points and vectors&#39;</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;$x_1$&#39;</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;$x_2$&#39;</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>

<span class="c1"># Right: g(t) vs t</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t_vals</span><span class="p">,</span> <span class="n">g_vals</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">r</span><span class="s1">&#39;$g(t)=f((1-t)\mathbf</span><span class="si">{x}</span><span class="s1">+t\mathbf</span><span class="si">{y}</span><span class="s1">)$&#39;</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t_vals</span><span class="p">,</span> <span class="n">secant_line</span><span class="p">,</span> <span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Secant line&#39;</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t_vals</span><span class="p">,</span> <span class="n">tangent_line</span><span class="p">,</span> <span class="s1">&#39;:&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Tangent at $t=0.5$&#39;</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">scatter</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">],</span> <span class="p">[</span><span class="n">f_x</span><span class="p">,</span> <span class="n">f_y</span><span class="p">,</span> <span class="n">f2d</span><span class="p">(</span><span class="n">z</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">newaxis</span><span class="p">,</span> <span class="p">:])[</span><span class="mi">0</span><span class="p">]],</span>
            <span class="n">color</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;blue&#39;</span><span class="p">,</span> <span class="s1">&#39;green&#39;</span><span class="p">,</span> <span class="s1">&#39;red&#39;</span><span class="p">],</span> <span class="n">s</span><span class="o">=</span><span class="mi">80</span><span class="p">)</span>

<span class="n">ax2</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;1D View: $g(t)$, Secant vs. Tangent at $c=0.5$&#39;</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;t&#39;</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;g(t)&#39;</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<img alt="../_images/82e6202de8970ddb01becc5323eb4f4e5f31869e3d49b926d2905a93e7798539.png" src="../_images/82e6202de8970ddb01becc5323eb4f4e5f31869e3d49b926d2905a93e7798539.png" />
</div>
</div>
<p>The left plot shows the contour of the function <span class="math notranslate nohighlight">\(f(x_1,x_2)=x_1^2+x_2^2\)</span> in <span class="math notranslate nohighlight">\(\mathbb{R}^2\)</span>, with the points <span class="math notranslate nohighlight">\(\mathbf{x}\)</span>, <span class="math notranslate nohighlight">\(\mathbf{y}\)</span>, and their midpoint <span class="math notranslate nohighlight">\(\mathbf{z}\)</span> marked. The right plot shows the function <span class="math notranslate nohighlight">\(g(t)=f\bigl((1-t)\mathbf{x} + t\,\mathbf{y}\bigr)\)</span> as a function of <span class="math notranslate nohighlight">\(t\)</span>.
In the right plot, the secant line (dashed) connects <span class="math notranslate nohighlight">\(g(0)=f(\mathbf{x})\)</span> and <span class="math notranslate nohighlight">\(g(1)=f(\mathbf{y})\)</span>, while the tangent line (dotted) at <span class="math notranslate nohighlight">\(t=0.5\)</span> has the same slope as the secant line.</p>
<div class="proof admonition" id="proof">
<p>Proof. Let <span class="math notranslate nohighlight">\(f:\mathbf{R}^n\to\mathbf{R}\)</span> be continuously differentiable, and pick any two points <span class="math notranslate nohighlight">\(\mathbf{x},\mathbf{y}\in\mathbf{R}^n\)</span>.  We want to relate</p>
<div class="math notranslate nohighlight">
\[
f(\mathbf{y})-f(\mathbf{x})
\]</div>
<p>to the gradient of <span class="math notranslate nohighlight">\(f\)</span>.</p>
<p>To do so, we need to parameterize the line segment:
Define</p>
<div class="math notranslate nohighlight">
\[
     \mathbf{z}(t)\;=\;(1-t)\,\mathbf{x} \;+\;t\,\mathbf{y},
     \quad t\in[0,1].
   \]</div>
<p>Then <span class="math notranslate nohighlight">\(\mathbf{z}(0)=\mathbf{x}\)</span> and <span class="math notranslate nohighlight">\(\mathbf{z}(1)=\mathbf{y}\)</span>.</p>
<p>Next, we build a one‐variable function on the line segment.<br />
Consider</p>
<div class="math notranslate nohighlight">
\[
     g(t)\;=\;f\bigl(\mathbf{z}(t)\bigr)\;=\;f\bigl((1-t)\mathbf{x} + t\mathbf{y}\bigr).
   \]</div>
<p>Since <span class="math notranslate nohighlight">\(\mathbf{z}\)</span> is affine and <span class="math notranslate nohighlight">\(f\)</span> is differentiable, <span class="math notranslate nohighlight">\(g\)</span> is differentiable on <span class="math notranslate nohighlight">\([0,1]\)</span>.</p>
<p>This definition allows us to apply the <strong>1D MVT</strong> to <span class="math notranslate nohighlight">\(g\)</span>.<br />
By the single‐variable Mean Value Theorem, there exists some <span class="math notranslate nohighlight">\(c\in(0,1)\)</span> such that</p>
<div class="math notranslate nohighlight">
\[
     g(1)-g(0)
     \;=\;
     g'(c).
   \]</div>
<p>But <span class="math notranslate nohighlight">\(g(1)=f(\mathbf{y})\)</span> and <span class="math notranslate nohighlight">\(g(0)=f(\mathbf{x})\)</span>, so</p>
<div class="math notranslate nohighlight">
\[
     f(\mathbf{y})-f(\mathbf{x})
     \;=\;
     g'(c).
   \]</div>
<p>We need to compute <span class="math notranslate nohighlight">\(g'(c)\)</span>.
Remember that <span class="math notranslate nohighlight">\(g(t)=f\bigl(\mathbf{z}(t)\bigr)\)</span>, so we can apply the <strong>chain rule</strong>:</p>
<div class="math notranslate nohighlight">
\[
     g'(t)
     \;=\;
     \nabla f\bigl(\mathbf{z}(t)\bigr)^\top\,\mathbf{z}'(t).
   \]</div>
<p>Here <span class="math notranslate nohighlight">\(\nabla f\)</span> is the gradient of <span class="math notranslate nohighlight">\(f\)</span> at <span class="math notranslate nohighlight">\(\mathbf{z}(t)\)</span>, and <span class="math notranslate nohighlight">\(\mathbf{z}'(t)\)</span> is the vector of partial derivatives of <span class="math notranslate nohighlight">\(\mathbf{z}\)</span> at <span class="math notranslate nohighlight">\(t\)</span>:</p>
<div class="math notranslate nohighlight">
\[\mathbf{z}'(t)=\dfrac{\operatorname{d}}{\operatorname{d}t}\bigl((1-t)\mathbf{x} + t\mathbf{y}\bigr)=\mathbf{y}-\mathbf{x}.\]</div>
<p>Hence</p>
<div class="math notranslate nohighlight">
\[
     g'(t)
     = \nabla f\bigl(\mathbf{z}(t)\bigr)^\top(\mathbf{y}-\mathbf{x}).
   \]</div>
<p>In particular, at <span class="math notranslate nohighlight">\(t=c\)</span>:</p>
<div class="math notranslate nohighlight">
\[
     g'(c)
     = \nabla f\bigl((1-c)\mathbf{x} + c\mathbf{y}\bigr)^\top(\mathbf{y}-\mathbf{x}).
   \]</div>
<p>If we <strong>combine the previous steps</strong>, we have</p>
<div class="math notranslate nohighlight">
\[
     f(\mathbf{y})-f(\mathbf{x})
     = \nabla f\bigl((1-c)\mathbf{x} + c\mathbf{y}\bigr)^\top(\mathbf{y}-\mathbf{x}).
   \]</div>
</div>
<p>Finally, we can <strong>derive a Lipschitz bound via the Cauchy–Schwarz inequality</strong>.</p>
<div class="proof corollary admonition" id="thm-lipschitz-continuity">
<p class="admonition-title"><span>Corollary </span> (Lipschitz continuity)</p>
<section class="corollary-content" id="proof-content">
<p>If <span class="math notranslate nohighlight">\(f:\mathbf{R}^n\to\mathbf{R}\)</span> is continuously differentiable, then for any two points <span class="math notranslate nohighlight">\(\mathbf{x},\mathbf{y}\in\mathbf{R}^n\)</span>, there exists a point <span class="math notranslate nohighlight">\(\mathbf{z}\)</span> on the line segment <span class="math notranslate nohighlight">\(\mathbf{z}(t)=(1-t)\mathbf{x}+t\mathbf{y}\)</span>, <span class="math notranslate nohighlight">\(t\in[0,1]\)</span>, such that</p>
<div class="math notranslate nohighlight">
\[
     \bigl|f(\mathbf{y})-f(\mathbf{x})\bigr|
     = \bigl|\nabla f(\mathbf{z})^\top(\mathbf{y}-\mathbf{x})\bigr|
     \;\le\;
     \|\nabla f(\mathbf{z})\|_2\;\|\mathbf{y}-\mathbf{x}\|_2.
   \]</div>
<p>If moreover <span class="math notranslate nohighlight">\(\|\nabla f(\mathbf{z})\|\le L\)</span> everywhere along the segment, then</p>
<div class="math notranslate nohighlight">
\[
     \bigl|f(\mathbf{y})-f(\mathbf{x})\bigr|\le L\,\|\mathbf{y}-\mathbf{x}\|,
   \]</div>
</section>
</div><p>In the latter case, we say that <span class="math notranslate nohighlight">\(f\)</span> is <strong>Lipschitz continuous</strong> with constant <span class="math notranslate nohighlight">\(L\)</span>. In other words, the function <span class="math notranslate nohighlight">\(f\)</span> does not change too rapidly.
This is a very useful property, as it allows us to control the difference in function values based on the distance between points in the domain.
This is particularly important in optimization, where we want to ensure that small changes in the input lead to small changes in the output, a property that is often desired for convergence of algorithms.</p>
<div class="proof admonition" id="proof">
<p>Proof. Lipschitz continuity</p>
<p>Let <span class="math notranslate nohighlight">\(f:\mathbf{R}^n\to\mathbf{R}\)</span> be continuously differentiable, and pick any two points <span class="math notranslate nohighlight">\(\mathbf{x},\mathbf{y}\in\mathbf{R}^n\)</span>.<br />
We have already shown that there exists a point <span class="math notranslate nohighlight">\(\mathbf{z}(c)=(1-c)\mathbf{x}+c\mathbf{y}\)</span> on the line segment between <span class="math notranslate nohighlight">\(\mathbf{x}\)</span> and <span class="math notranslate nohighlight">\(\mathbf{y}\)</span> such that</p>
<div class="math notranslate nohighlight">
\[
     f(\mathbf{y})-f(\mathbf{x})
     = \nabla f\bigl((1-c)\mathbf{x} + c\mathbf{y}\bigr)^\top(\mathbf{y}-\mathbf{x}).
   \]</div>
<p>The first ressult follows from the <strong>Cauchy–Schwarz inequality</strong>:</p>
<div class="math notranslate nohighlight">
\[
     \bigl|f(\mathbf{y})-f(\mathbf{x})\bigr|
     = \bigl|\nabla f\bigl((1-c)\mathbf{x} + c\mathbf{y}\bigr)^\top(\mathbf{y}-\mathbf{x})\bigr|
     \;\le\;
     \|\nabla f\bigl((1-c)\mathbf{x} + c\mathbf{y}\bigr)\|_2\;\|\mathbf{y}-\mathbf{x}\|_2.
   \]</div>
<p>If we assume that <span class="math notranslate nohighlight">\(\|\nabla f(\mathbf{z})\|\le L\)</span> everywhere along the segment, then we can bound the right-hand side by <span class="math notranslate nohighlight">\(L\,\|\mathbf{y}-\mathbf{x}\|_2\)</span> to get the second result:</p>
<div class="math notranslate nohighlight">
\[
     \bigl|f(\mathbf{y})-f(\mathbf{x})\bigr|
     \;\le\;
     L\,\|\mathbf{y}-\mathbf{x}\|_2.
   \]</div>
<p>This shows that <span class="math notranslate nohighlight">\(f\)</span> is Lipschitz continuous with constant <span class="math notranslate nohighlight">\(L\)</span>.</p>
</div>
</section>
<section id="mean-value-theorem-for-vector-valued-functions">
<h2>Mean Value Theorem for Vector-Valued Functions<a class="headerlink" href="#mean-value-theorem-for-vector-valued-functions" title="Link to this heading">#</a></h2>
<p>The standard Mean Value Theorem (MVT) holds for real-valued functions <span class="math notranslate nohighlight">\(f:\mathbb{R} \to \mathbb{R}\)</span>.
However, for vector-valued functions <span class="math notranslate nohighlight">\(\mathbf{f}:\mathbb{R}^n \to \mathbb{R}^m\)</span>, a direct analog generally <strong>does not exist</strong>.
This is because applying the mean value theorem componentwise results in different intermediate points <span class="math notranslate nohighlight">\(t_i\)</span> for each component, making it impossible, in general, to find a single point that satisfies the theorem for all components simultaneously.</p>
<p>Instead, a useful generalized form involving integrals (the Jacobian Lemma) can be employed.</p>
<p>Let <span class="math notranslate nohighlight">\(\mathbf{f}:\mathbb{R}^n\to\mathbb{R}^m\)</span> be continuously differentiable, and let <span class="math notranslate nohighlight">\(\mathbf{x},\mathbf{h}\in\mathbb{R}^n\)</span>. Then, there exists an integral-based formula involving the Jacobian matrix <span class="math notranslate nohighlight">\(\mathbf{J}_{\mathbf{f}}\)</span>, defined as:</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\mathbf{J}_{\mathbf{f}}(\mathbf{x}) = 
\begin{pmatrix}
\frac{\partial f_1}{\partial x_1} &amp; \cdots &amp; \frac{\partial f_1}{\partial x_n}\\[6pt]
\vdots &amp; \ddots &amp; \vdots \\[6pt]
\frac{\partial f_m}{\partial x_1} &amp; \cdots &amp; \frac{\partial f_m}{\partial x_n}
\end{pmatrix}.
\end{split}\]</div>
<p>The lemma is stated rigorously as follows:</p>
<div class="proof theorem admonition" id="thm-Jacobian">
<p class="admonition-title"><span>Theorem </span> (Jacobian Lemma (Generalized Vector-Valued MVT))</p>
<section class="theorem-content" id="proof-content">
<p>Let <span class="math notranslate nohighlight">\(\mathbf{f}:\mathbb{R}^n\to\mathbb{R}^m\)</span> be continuously differentiable, and let <span class="math notranslate nohighlight">\(\mathbf{x},\mathbf{h}\in\mathbb{R}^n\)</span>.</p>
<p>Then:</p>
<div class="math notranslate nohighlight">
\[
\mathbf{f}(\mathbf{x}+\mathbf{h}) - \mathbf{f}(\mathbf{x})
= \left(\int_0^1 \mathbf{J}_{\mathbf{f}}(\mathbf{x}+t\mathbf{h})\,\mathrm{d}t\right)\mathbf{h},
\]</div>
<p>where the integral of the Jacobian matrix is understood componentwise.</p>
</section>
</div><p>Note that the comoponent-wise integral of Jacobian yields an <span class="math notranslate nohighlight">\(m\times n\)</span> matrix. Thus, the right-hand side of the equation is a matrix-vector product, yielding a vector in <span class="math notranslate nohighlight">\(\mathbb{R}^m\)</span>.</p>
<div class="proof admonition" id="proof">
<p>Proof. Jacobian Lemma</p>
<p>We will prove the Jacobian lemma using the <strong>chain rule</strong> and the <strong>Second Fundamental Theorem of Calculus</strong>.
Let <span class="math notranslate nohighlight">\(\mathbf{f}:\mathbb{R}^n\to\mathbb{R}^m\)</span> be continuously differentiable, and let <span class="math notranslate nohighlight">\(\mathbf{x},\mathbf{h}\in\mathbb{R}^n\)</span>.</p>
<p>We will need two ingredients:</p>
<p><strong>Ingredient 1: Define the auxiliary function.</strong></p>
<p>We define the auxiliary function <span class="math notranslate nohighlight">\(\mathbf{g}(t)\)</span> by:</p>
<div class="math notranslate nohighlight">
\[
\mathbf{g}(t) = \mathbf{f}(\mathbf{x}+t\mathbf{h}),\quad t\in[0,1].
\]</div>
<p>Then <span class="math notranslate nohighlight">\(\mathbf{g}\)</span> is differentiable and by the <strong>chain rule</strong>, we get the vector-valued derivative:</p>
<div class="math notranslate nohighlight">
\[
\mathbf{g}'(t) = \mathbf{J}_{\mathbf{f}}(\mathbf{x}+t\mathbf{h})\,\mathbf{h}.
\]</div>
<p><strong>Ingredient 2: Apply the Fundamental Theorem of Calculus.</strong></p>
<p>By the <strong>Second Fundamental Theorem of Calculus</strong> that states that the difference of a function over an interval <span class="math notranslate nohighlight">\([a,b]\)</span> can be expressed as the integral of its derivative over that interval, we have:</p>
<div class="math notranslate nohighlight">
\[
\mathbf{g}(b) - \mathbf{g}(a) = \int_a^b \mathbf{g}'(t)\,\mathrm{d}t.
\]</div>
<p><strong>Putting it together:</strong></p>
<p>Our goal is to express the difference <span class="math notranslate nohighlight">\(\mathbf{f}(\mathbf{x}+\mathbf{h}) - \mathbf{f}(\mathbf{x})\)</span> in terms of the integral of the Jacobian matrix.</p>
<p>We can do this by substituting the definition of <span class="math notranslate nohighlight">\(\mathbf{g}(t)\)</span> in ingredient 1, the difference if <span class="math notranslate nohighlight">\(\mathbf{f}(\mathbf{x}+\mathbf{h})\)</span> and <span class="math notranslate nohighlight">\(\mathbf{f}(\mathbf{x})\)</span> can be expressed as the change in <span class="math notranslate nohighlight">\(\mathbf{g}\)</span> over the interval <span class="math notranslate nohighlight">\([0,1]\)</span>:</p>
<div class="math notranslate nohighlight">
\[
\mathbf{f}(\mathbf{x}+\mathbf{h}) - \mathbf{f}(\mathbf{x}) = \mathbf{g}(1) - \mathbf{g}(0).
\]</div>
<p>Using ingriedient 2, we can express this difference in the values of <span class="math notranslate nohighlight">\(\mathbf{g}\)</span> at points <span class="math notranslate nohighlight">\(0\)</span> and <span class="math notranslate nohighlight">\(1\)</span> as the integral of its derivative over the interval <span class="math notranslate nohighlight">\([0,1]\)</span>:</p>
<div class="math notranslate nohighlight">
\[
= \int_0^1 \mathbf{g}'(t)\,\mathrm{d}t.
\]</div>
<p>Plugging in the expression for <span class="math notranslate nohighlight">\(\mathbf{g}'(t)\)</span> derived above gives us:</p>
<div class="math notranslate nohighlight">
\[
= \int_0^1 \mathbf{J}_{\mathbf{f}}(\mathbf{x}+t\mathbf{h})\,\mathbf{h}\,\mathrm{d}t.
\]</div>
<p>Since <span class="math notranslate nohighlight">\(\mathbf{h}\)</span> is constant, we factor it out to the right to obtain the desired result:</p>
<div class="math notranslate nohighlight">
\[
= \left(\int_0^1 \mathbf{J}_{\mathbf{f}}(\mathbf{x}+t\mathbf{h})\,\mathrm{d}t\right)\mathbf{h}.
\]</div>
<p>This proves the Jacobian Lemma. ◻</p>
</div>
<p>The Jacobian lemma is particularly useful in optimization and numerical analysis, as it allows us to approximate the change in a vector-valued function using the average of its Jacobian over the interval. This is especially important when dealing with high-dimensional spaces, where direct computation of the function’s value can be expensive.</p>
</section>
<section id="summary">
<h2>Summary<a class="headerlink" href="#summary" title="Link to this heading">#</a></h2>
<p>In summary, the Mean Value Theorem and its generalizations, such as the Jacobian lemma, are essential tools in calculus and optimization. They provide a framework for understanding the behavior of functions and their derivatives.</p>
<p>Next, we will use the Mean Value Theorem and the Jacobian lemma to analyze optimality conditions and convergence properties of the gradient descent algorithm.</p>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./chapter_calculus"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="chain_rule.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">The chain rule</p>
      </div>
    </a>
    <a class="right-next"
       href="minima_first_order_condition.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">First-order condition for local minima</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#mean-value-theorem-in-1-variable">Mean value theorem in 1 variable</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#mean-value-theorem-for-real-valued-functions-in-several-variables">Mean Value Theorem for real-valued Functions in Several Variables</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#mean-value-theorem-for-vector-valued-functions">Mean Value Theorem for Vector-Valued Functions</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#summary">Summary</a></li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Christoph Lippert
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2023.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
<div class="extra_footer">
  <script src="https://giscus.app/client.js"
        data-repo="HealthML/Math4ML"
        data-repo-id="R_kgDON-O79w"
        data-category="Comments"
        data-category-id="DIC_kwDON-O7984Co2qc"
        data-mapping="pathname"
        data-strict="1"
        data-reactions-enabled="1"
        data-emit-metadata="0"
        data-input-position="top"
        data-theme="preferred_color_scheme"
        data-lang="en"
        data-loading="lazy"
        crossorigin="anonymous"
        async>
</script>

</div>
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b"></script>
<script src="../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>